
<div class="ekos-annotator">
	<script type="application/json">
			{
			    "baseUrl": "https://ekos-mturk-test-samples.s3.us-east-2.amazonaws.com/frames",
				"noun": "onion",
				"images": [
					{"file_name": "P02_03_126_23186_post_xmem_onion.jpg"},
					{"file_name": "P02_03_126_23186_post_xmem_onion.jpg"},
					{"file_name": "P02_03_126_23186_post_xmem_onion.jpg"},
					{"file_name": "P02_03_126_23186_post_xmem_onion.jpg"},
					{"file_name": "P02_03_126_23186_post_xmem_onion.jpg"},
					{"file_name": "P02_03_126_23186_post_xmem_onion.jpg"},
					{"file_name": "P02_03_126_23186_post_xmem_onion.jpg"},
					{"file_name": "P02_03_126_23186_post_xmem_onion.jpg"},
					{"file_name": "P02_03_126_23186_post_xmem_onion.jpg"}
				]
			}
		  </script>
	</div>
<script src="https://cdn.jsdelivr.net/gh/beasteers/ekos-annotator@main/build/bundle.js" data-mount-in=".ekos-annotator" type="text/javascript"></script>

<script type='text/javascript' src='https://s3.amazonaws.com/mturk-public/externalHIT_v1.js'></script>
<form method='post' id='mturk_form' action='https://workersandbox.mturk.com/mturk/externalSubmit'>
	<input type="hidden" name="assignmentId" />
    <input type="hidden" name"answer" />
</form>
<script language='Javascript'>turkSetAssignmentID()</script>

<script type="text/javascript">
function dumpForm(form) {
  return (
    [...new FormData(form).entries()].reduce((acc, [key, value]) => {
      acc[key] = acc[key] ? [].concat(acc[key], value) : value;
      return acc;
    }, {})
  );
}
document.addEventListener('DOMContentLoaded', function() {
    // Select all forms with class 'ekos-annotator' and their submit buttons
    const form = document.querySelectorAll('.ekos-annotator form')[0];
    const outForm = document.querySelectorAll('crowd-form')[0];
    console.log(dumpForm(form))
    form.addEventListener('submit', function(e) {
        e.preventDefault();

        const formData = dumpForm(form);
        console.log(formData);

        const answerInput = outForm.querySelector('input[name=answer]');
        answerInput.value = JSON.stringify(formData);
        outForm.submit();
    });
});
</script>